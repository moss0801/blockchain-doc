
Hyperledeger Fabric v2.4 Custom Network 구성

* Docker Compose 사용 (Docker Compose 성공하면 k8s로 변경하여 수정 예정)
* Fabric CA 사용
* LevelDB 사용 (LevelDB 성공하면 CouchDB로 변경하여 수정 예정)

## 네트워크 구성 요소
* Orderer 1개
* Organization 2개
* Organization 별 Peer 1개
* Organization 별 Admin 1명, User 1명
* Organization 별 Cli 1개
* Channel 1개 - 모든 Orderer 및 Peer 가입(Join)

## 네트워크 구성 순서

* 조직별 CA 생성 및 Contrainer 실행
* 조직별 Identity 생성
* Peer를 포함하는 조직의 CCP 생성
* Container 실행 (Orderer, Peer, Cli)
* configtxgen을 이용하여 채널 genesis block 생성(Configuration Block) /w configtx.yaml
* osnadmin을 이용하여 채널 생성 및 Orderer 채널 가입 /w 채널 genesis block
* 각 조직의 Peer들을 채널에 가입(Join)
* 각 조직의 AnchorPeer 설정

### 조직별 CA 생성 및 Contrainer 실행

1. 조직별 CA 설정파일 작성 - link:https://github.com/hyperledger/fabric-samples/blob/main/test-network/organizations/fabric-ca/org1/fabric-ca-server-config.yaml[Org1], link:https://github.com/hyperledger/fabric-samples/blob/main/test-network/organizations/fabric-ca/ordererOrg/fabric-ca-server-config.yaml[Orderer]
2. 'docker-compose-ca.yaml' CA Docker Compose 설정파일 작성 - link:https://github.com/hyperledger/fabric-samples/blob/main/test-network/compose/compose-ca.yaml[test-network compose-ca.yaml]
3. cotainer 배포 +
docker-compose -f compose-ca.yaml up -d 2>&1
4. ca Identity 파일 확인 (./organizations/fabric-ca/{organizationName})
```
./
├── IssuerPublicKey
├── IssuerRevocationPublicKey
├── ca-cert.pem
├── fabric-ca-server-config.yaml
├── fabric-ca-server.db
├── msp
│   ├── cacerts
│   ├── keystore
│   │   ├── 84cb92646b3b7a74bd77f8727aa5b3871e7a6aaf34a2949a3d6ab77badb551d0_sk
│   │   ├── IssuerRevocationPrivateKey
│   │   ├── IssuerSecretKey
│   │   └── a11b524715aec040c0b352efcc4dfc939e9850ff1e40532f766a5bf3aca665a6_sk
│   ├── signcerts
│   └── user
└── tls-cert.pem
```

**참고: 2>&1** - link:https://reebok.tistory.com/56[/dev/null 2>&1 의 의미]

n >&m: 표준출력과 표준에러를 서로 바꾸기. +
0, 1, 2는 각각 표준입력, 표준출력, 그리고 표준에러를 의미합니다. 

2>&1의 의미는 표준 출력의 전달되는 곳으로 표준에러를 전달하라라는 의미입니다. 

### 조직별 Identity 생성

link:https://hyperledger-fabric-ca.readthedocs.io/en/release-1.4/deployguide/use_CA.html#folder-structure-for-your-org-and-node-admin-identities[Folder structure for your org and node admin identities]

image:https://hyperledger-fabric-ca.readthedocs.io/en/release-1.4/_images/organizationswithpeer.png[]

#### Peer 조직

. fabric-ca-clinet enroll 이용하여 CA admin 등록(enroll)
. 기본 설정 파일(fabric-ca-client-config.yaml) 수정 (CA Admin enroll시 생성)
. fabric-ca-clinet register 이용하여 Peer 'peer0' 등록(register)
. fabric-ca-clinet register 이용하여 User 'user' 등록(register)
. fabric-ca-clinet register 이용하여 User 'org admin' 등록(register)
. fabric-ca-clinet enroll 이용하여 Peer 'peer0' msp 생성
. fabric-ca-clinet enroll 이용하여 Peer 'peer0-tls' certificates 생성
. fabric-ca-clinet enroll 이용하여 User 'user' msp 생성
. fabric-ca-clinet enroll 이용하여 User 'org admin' msp 생성


#### Orderer 조직

. fabric-ca-clinet enroll 이용하여 CA admin 등록(enroll)
. 기본 설정 파일(fabric-ca-client-config.yaml) 수정 (CA Admin enroll시 생성)
. fabric-ca-clinet register 이용하여 Orderer 'orderer' 등록(register)
. fabric-ca-clinet register 이용하여 Admin 'ordererAdmin' 등록(register)
. fabric-ca-clinet enroll 이용하여 Orderer 'orderer' msp 생성
. fabric-ca-clinet enroll 이용하여 Orderer 'orderer-tls' certificates 생성
. fabric-ca-clinet enroll 이용하여 Admin 'ordererAdmin' msp 생성

### Peer를 포함하는 조직의 CCP 생성

link:https://github.com/hyperledger/fabric-samples/blob/main/test-network/organizations/ccp-template.yaml[ccp-template.yaml], link:https://github.com/hyperledger/fabric-samples/blob/main/test-network/organizations/ccp-generate.sh[ccp-generate.sh]

/organizations/ccp-template.yaml 및 /organizations/ccp-template.sh를 참고하여,
Peer를 포함하는 조직의 CCP 파일 생성

조직별로 아래 파일들이 생성되어야 합니다.

/organizations/peerOrganizations/{organization}.{domain}/connection-{organization}.yaml

예) domain: moss.com, organization: service1 +
/organizations/peerOrganizations/service1.moss.com/connection-service1.yaml

ccp(common connection profile): application에서 gateway를 설정하여 network 와의 통신을 관리하는 데 사용됩니다.

### Container 실행 (Orderer, Peer, Cli)
. 'compose-network.yaml' 네트워크 Docker Compose 설정파일 작성, 참고: link:https://github.com/hyperledger/fabric-samples/blob/main/test-network/compose/compose-test-net.yaml[compose-tesk-net.yaml] +
test-network와 다르게 Peer Organization 별 Cli를 1개씩 정의 했으므로 Cli Container가 한개 더 추가된다.
. cotainer 배포 +
docker-compose -f compose-network.yaml up -d 2>&1
. container 정상 동작 확인 : orderer 1개, peer 2개, cli 2개 (앞에서 실행한 ca3 개를 포함하여 총 8개) +
docker container ls

조금 더 발전된 형태는 인증서 파일들을 mount 하는 것이 아닌 파일들을 복사한 새로운 이미지를 만들어서 배포하는 것일 것이다. k8s를 이용하면 PV를 이용하여 인증서를 공유하고 mount하여 처리 하는 것도 고려해 볼 수 있다.

### configtxgen을 이용하여 채널 genesis block 생성(Configuration Block) /w configtx.yaml

. 채널명 환경변수 설정 : CHANNEL_NAME="mosschannel"
. ./../config/configtx.yaml 채널 설정 파일을 작성한다. 참고: link:https://github.com/hyperledger/fabric-samples/blob/main/test-network/configtx/configtx.yaml[configtx.yaml]
. 환경변수 설정 - FABRIC_CFG_PATH=${PWD}/configtx
. block 생성 +
configtxgen -profile TwoOrgsApplicationGenesis -outputBlock ./channel-artifacts/${CHANNEL_NAME}.block -channelID $CHANNEL_NAME
. 환경변수 경로 재설정 - FABRIC_CFG_PATH=$PWD/../config/
. 채널 genesis block 경로 환경변수 설정 - BLOCKFILE="./channel-artifacts/${CHANNEL_NAME}.block"

### osnadmin을 이용하여 채널 생성 및 Orderer 채널 가입 /w 채널 genesis block

. $FABRIC_CFG_PATH/orderer.yaml Orderer 설정파일 수정
. osnadmin channel join 를 이용하여 채널 genesis block으로 채널 생성(존재하지 않으면 생성) 및 Orderer를 채널에 가입 +
osnadmin channel join --channelID $CHANNEL_NAME --config-block ./channel-artifacts/${CHANNEL_NAME}.block -o localhost:7053 --ca-file "$ORDERER_CA" --client-cert "$ORDERER_ADMIN_TLS_SIGN_CERT" --client-key "$ORDERER_ADMIN_TLS_PRIVATE_KEY" + 
osnadmin channel join --channelID mychannel --config-block ./channel-artifacts/mychannel.block -o localhost:7053 --ca-file ./ordererOrganizations/example.com/tlsca/tlsca.example.com-cert.pem --client-cert ./organizations/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.crt --client-key ./organizations/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.key

### 각 조직의 Peer들을 채널에 가입(Join)

. peer channel join 명령어 실행을 위한 환경변수 설정
.. export CORE_PEER_LOCALMSPID="Org1MSP"
.. export CORE_PEER_TLS_ROOTCERT_FILE=$PEER0_ORG1_CA
.. export CORE_PEER_MSPCONFIGPATH=${PWD}/organizations/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
.. export CORE_PEER_ADDRESS=localhost:7051
.. 추가환경설정 변수 확인 필요
. peer channel join 명령어로 Peer의 채널 가입(join) - peer channel join -b $BLOCKFILE >&log.txt


### 각 조직의 AnchorPeer 설정
cli container에서 실행되어야 한다.

. 채널 config를 조회
. anchor peer에 추가를 위한 설정 수정
. 현재 설정과 수정된 설정의 diff로 config update tx(Org1MSPconfig.json) 생성
. AnchorPeer 수정

```
# 채널 config 조회
setGlobals 1
peer channel fetch config config_block.pb -o orderer.exmaple.com:7050 --ordererTLSHostnameOverride orderer.example.com -c mychannel --tls --cafile "./organizations/ordererOrganizations/example.com/tlsca/tlsca.example.com-cert.pem"
configtxlator proto_decode --input config_block.pb --type common.Block --output config_block.json
jq .data.data[0].payload.data.config config_block.json >"Org1MSPconfig.json"

# anchor peer에 추가를 위한 설정 수정
jq '.channel_group.groups.Application.groups.'Org1MSP}'.values += {"AnchorPeers":{"mod_policy": "Admins","value":{"anchor_peers": [{"host": "'peer0.org1.example.com'","port": '7051'}]},"version": "0"}}' Org1MSPconfig.json > Org1MSPmodified_config.json

# 현재 설정과 수정된 설정의 diff로 config update tx(Org1MSPconfig.json) 생성
configtxlator proto_encode --input "Org1MSPconfig.json" --type common.Config --output original_config.pb
configtxlator proto_encode --input "Org1MSPmodified_config.json" --type common.Config --output modified_config.pb
configtxlator compute_update --channel_id "mychannel" --original original_config.pb --updated modified_config.pb --output config_update.pb
configtxlator proto_decode --input config_update.pb --type common.ConfigUpdate --output config_update.json
echo '{"payload":{"header":{"channel_header":{"channel_id":"'mychannel'", "type":2}},"data":{"config_update":'$(cat config_update.json)'}}}' | jq . >config_update_in_envelope.json
configtxlator proto_encode --input config_update_in_envelope.json --type common.Envelope --output "Org1MSPanchors.tx"

# AnchorPeer 수정
peer channel update -o orderer.example.com:7050 --ordererTLSHostnameOverride orderer.example.com -c mychannel -f Org1MSPanchors.tx --tls --cafile "./organizations/ordererOrganizations/example.com/tlsca/tlsca.example.com-cert.pem" >&log.txt
```

## Custom Network Configuration
실제 Custom 네트워크 설정을 해본다. +
진행 환경은 'ubuntu' 또는 'wsl2(ubuntu) on windows 10' 에서 진행합니다. +
컨테이너 환경은 docker, docker-compose를 이용합니다.

* domain: moss.com
* channel : mosschannel
** ordererOrganizations: oderer1
** peerOrganizations: platform, customer, service1, service2
** policy: test-network default policy
* organizations
** orderer1
*** domain: orderer1.moss.com
*** users
**** admin
*** orderer node: 3개
**** osn1.orderer1.moss.com
**** osn2.orderer1.moss.com
**** osn3.orderer1.moss.com
** platform organization
*** domain: platform.moss.com
*** users
**** admin
**** user1
*** peer node: 2개
**** peer0.platform.moss.com (anchor peer)
**** peer1.platform.moss.com
** customer organization
*** domain: customer.moss.com
*** users
**** admin
**** user1
*** peer node: 2개
**** peer0.customer.moss.com (anchor peer)
**** peer1.customer.moss.com
** service1 organization
*** domain: service1.moss.com
*** users
**** admin
**** user1
*** peer node: 2개
**** peer0.service1.moss.com (anchor peer)
**** peer1.service1.moss.com
** service2 organization
*** domain: service2.moss.com
*** users
**** admin
**** user1
*** peer node: 2개
**** peer0.service2.moss.com (anchor peer)
**** peer1.service2.moss.com

### 바이너리 다운로드

moss-network 또는 임의의 폴더 생성 후, fabric, fabric-ca linux 바이너리를 다운받아서 압축을 풉니다. 이후 ./bin을 PATH 경로에 추가합니다.

진행의 편의를 위해서 moss-network 폴더 경로를 'FABRIC_NETWORK_HOME' 환경변수로 설정합니다.

* link:https://github.com/hyperledger/fabric/releases/tag/v2.4.2[fabric v2.4.2]
* link:https://github.com/hyperledger/fabric-ca/releases/tag/v1.5.2[fabric-ca v1.5.2]

```
mkdir moss-network
cd moss-network
export FABRIC_NETWORK_HOME=${PWD}

curl -L https://github.com/hyperledger/fabric/releases/download/v2.4.2/hyperledger-fabric-linux-amd64-2.4.2.tar.gz -o hyperledger-fabric-linux-amd64-2.4.2.tar.gz
curl -L https://github.com/hyperledger/fabric-ca/releases/download/v1.5.2/hyperledger-fabric-ca-linux-amd64-1.5.2.tar.gz -o hyperledger-fabric-ca-linux-amd64-1.5.2.tar.gz

sudo tar -zxvf hyperledger-fabric-linux-amd64-2.4.2.tar.gz
sudo tar -zxvf hyperledger-fabric-ca-linux-amd64-1.5.2.tar.gz

export PATH=${PWD}/bin:$PATH

```

작업 완료 후
```
/moss-network
├── bin
│   ├── configtxgen
│   ├── configtxlator
│   ├── cryptogen
│   ├── discover
│   ├── fabric-ca-client
│   ├── fabric-ca-server
│   ├── ledgerutil
│   ├── orderer
│   ├── osnadmin
│   └── peer
├── config
│   ├── configtx.yaml
│   ├── core.yaml
│   └── orderer.yaml
├── hyperledger-fabric-ca-linux-amd64-1.5.2.tar.gz
└── hyperledger-fabric-linux-amd64-2.4.2.tar.gz
```

### 조직별 CA 서버 설정 파일 작성

link:https://hyperledger-fabric-ca.readthedocs.io/en/latest/users-guide.html[Fabric CA User’s Guide], 
link:https://hyperledger-fabric-ca.readthedocs.io/en/latest/operations_guide.html[Fabric CA Operations Guide], 
link:https://hyperledger-fabric-ca.readthedocs.io/en/latest/deployguide/ca-deploy-topology.html[Planning for a CA], 
link:https://hyperledger-fabric-ca.readthedocs.io/en/latest/deployguide/cadeploy.html[CA Deployment steps]

조직(Organization)별 두 개의 CA(organization CA[블록체인 인증], TLS CA[보안통신 인증]) 설정이 추천되나, 여기서는 하나의 CA가 2개의 CA 역할을 모두 하도록 설정합니다.

조직별로 ./organizations/fabric-ca/{organizationName} 폴더를 생성하고, 조직별 설정파일(fabric-ca-server-config.yaml)을 작성합니다. 설정파일은 fabric-samples에서 다운받아 수정합니다.

* ./organizations/fabric-ca/orderer1/fabric-ca-server-config.yaml
* ./organizations/fabric-ca/platform/fabric-ca-server-config.yaml
* ./organizations/fabric-ca/customer/fabric-ca-server-config.yaml
* ./organizations/fabric-ca/service1/fabric-ca-server-config.yaml
* ./organizations/fabric-ca/service2/fabric-ca-server-config.yaml

```
cd "$FABRIC_NETWORK_HOME"

curl -L https://raw.githubusercontent.com/hyperledger/fabric-samples/main/test-network/organizations/fabric-ca/ordererOrg/fabric-ca-server-config.yaml -o fabric-ca-server-config.yaml

mkdir -p organizations/fabric-ca/orderer1 
mkdir -p organizations/fabric-ca/platform
mkdir -p organizations/fabric-ca/customer
mkdir -p organizations/fabric-ca/service1
mkdir -p organizations/fabric-ca/service2

cp fabric-ca-server-config.yaml organizations/fabric-ca/orderer1
cp fabric-ca-server-config.yaml organizations/fabric-ca/platform
cp fabric-ca-server-config.yaml organizations/fabric-ca/customer
cp fabric-ca-server-config.yaml organizations/fabric-ca/service1
cp fabric-ca-server-config.yaml organizations/fabric-ca/service2

rm fabric-ca-server-config.yaml

```

아래는 파일별 수정한 내용만 표시했습니다.

```
# organizations/fabric-ca/orderer1/fabric-ca-server-config.yaml
...
ca:
  # Name of this CA
  name: Orderer1CA
...
registry:
  # Contains identity information which is used when LDAP is disabled
  identities:
     - name: o1admin
       pass: o1adminpw
...
csr:
   cn: ca.orderer1.moss.com
   names:
      - C: KR
        S: "Gyeonggi-Do"
        L: "Seongnam-si"
        O: Moss
        OU:
   hosts:
     - localhost
     - orderer1.moss.com
...

```

```
# organizations/fabric-ca/platform/fabric-ca-server-config.yaml
...
ca:
  # Name of this CA
  name: PlatformCA
...
registry:
  # Contains identity information which is used when LDAP is disabled
  identities:
     - name: padmin
       pass: padminpw
...
csr:
   cn: ca.platform.moss.com
   names:
      - C: KR
        S: "Gyeonggi-Do"
        L: "Seongnam-si"
        O: platform.moss.com
        OU:
   hosts:
     - localhost
     - platform.moss.com
...

```

```
# organizations/fabric-ca/customer/fabric-ca-server-config.yaml
...
ca:
  # Name of this CA
  name: CustomerCA
...
registry:
  # Contains identity information which is used when LDAP is disabled
  identities:
     - name: cadmin
       pass: cadminpw
...
csr:
   cn: ca.customer.moss.com
   names:
      - C: KR
        S: "Gyeonggi-Do"
        L: "Seongnam-si"
        O: customer.moss.com
        OU:
   hosts:
     - localhost
     - customer.moss.com
...

```

```
# organizations/fabric-ca/service1/fabric-ca-server-config.yaml
...
ca:
  # Name of this CA
  name: Service1CA
...
registry:
  # Contains identity information which is used when LDAP is disabled
  identities:
     - name: s1admin
       pass: s1adminpw
...
csr:
   cn: ca.service1.moss.com
   names:
      - C: KR
        S: "Gyeonggi-Do"
        L: "Seongnam-si"
        O: service1.moss.com
        OU:
   hosts:
     - localhost
     - service1.moss.com
...

```

```
# organizations/fabric-ca/service2/fabric-ca-server-config.yaml
...
ca:
  # Name of this CA
  name: Service2CA
...
registry:
  # Contains identity information which is used when LDAP is disabled
  identities:
     - name: s2admin
       pass: s2adminpw
...
csr:
   cn: ca.service2.moss.com
   names:
      - C: KR
        S: "Gyeonggi-Do"
        L: "Seongnam-si"
        O: service2.moss.com
        OU:
   hosts:
     - localhost
     - service2.moss.com
...

```

작업 후 폴더구조는 아래와 같습니다.

```
/moss-network
...
└── organizations
    └── fabric-ca
        ├── customer
        │   └── fabric-ca-server-config.yaml
        ├── orderer1
        │   └── fabric-ca-server-config.yaml
        ├── platform
        │   └── fabric-ca-server-config.yaml
        ├── service1
        │   └── fabric-ca-server-config.yaml
        └── service2
            └── fabric-ca-server-config.yaml
```

### Fabric-CA 초기화

'fabric-ca-server init'을 'fabric-ca-server-config.yaml' 함께 초기화 합니다.
초기화 마다 CA 경로를 'FABRIC_CA_HOME' 환경변수로 지정하거나, '--home' flag로 지정해 주어야 합니다.

초기화가 완료되면 CA 의 identitiy 관련 리소스 및 msp가 생성됩니다.

```
cd "$FABRIC_NETWORK_HOME"

fabric-ca-server init --home organizations/fabric-ca/orderer1
fabric-ca-server init --home organizations/fabric-ca/platform
fabric-ca-server init --home organizations/fabric-ca/customer
fabric-ca-server init --home organizations/fabric-ca/service1
fabric-ca-server init --home organizations/fabric-ca/service2

```

orderer1 실행 결과
```
./
...
└── organizations
    └── fabric-ca
        ...
        ├── orderer1
        │   ├── IssuerPublicKey
        │   ├── IssuerRevocationPublicKey
        │   ├── ca-cert.pem
        │   ├── fabric-ca-server-config.yaml
        │   ├── fabric-ca-server.db
        │   └── msp
        │       └── keystore
        │           ├── 0088ced00ae5e283443796f7e5a6d37219bde24f6234c3958cc6320f56297c29_sk
        │           ├── IssuerRevocationPrivateKey
        │           └── IssuerSecretKey
        ...
```

* ca-cert.pem: CA 인증서(Certificates)
* fabric-ca-server.db: CA DB(sqllite3) - MySQL 또는 Postgresql로 변경할 수 있습니다.
* msp: Membership Service Provider
* msp/keystore/0088ced00ae5e283443796f7e5a6d37219bde24f6234c3958cc6320f56297c29_sk: CA 개인키
* Issuer~ 파일들: Idemix MSP와 연관된 공개키, 비밀키, link:https://hyperledger-fabric.readthedocs.io/en/release-2.4/idemix.html?highlight=IssuerPublicKey#how-to-use-idemix[How to use Idemix]

init 실행 로그
```
$ fabric-ca-server init --home organizations/fabric-ca/orderer1
2022/02/23 16:43:44 [INFO] Configuration file location: /moss-network/organizations/fabric-ca/orderer1/fabric-ca-server-config.yaml
2022/02/23 16:43:44 [WARNING] Unknown provider type: ; metrics disabled
2022/02/23 16:43:44 [INFO] Server Version: 1.5.2
2022/02/23 16:43:44 [INFO] Server Levels: &{Identity:2 Affiliation:1 Certificate:1 Credential:1 RAInfo:1 Nonce:1}
2022/02/23 16:43:44 [WARNING] &{69 The specified CA certificate file /moss-network/organizations/fabric-ca/orderer1/ca-cert.pem does not exist}
2022/02/23 16:43:44 [INFO] generating key: &{A:ecdsa S:256}
2022/02/23 16:43:44 [INFO] encoded CSR
2022/02/23 16:43:44 [INFO] signed certificate with serial number 269352255072886714176999719127157165508707073505
2022/02/23 16:43:44 [INFO] The CA key and certificate were generated for CA Orderer1CA
2022/02/23 16:43:44 [INFO] The key was stored by BCCSP provider 'SW'
2022/02/23 16:43:44 [INFO] The certificate is at: /moss-network/organizations/fabric-ca/orderer1/ca-cert.pem
2022/02/23 16:43:44 [INFO] Initialized sqlite3 database at /moss-network/organizations/fabric-ca/orderer1/fabric-ca-server.db
2022/02/23 16:43:45 [INFO] The issuer key was successfully stored. The public key is at: /moss-network/organizations/fabric-ca/orderer1/IssuerPublicKey, secret key is at: /moss-network/organizations/fabric-ca/orderer1/msp/keystore/IssuerSecretKey
2022/02/23 16:43:45 [INFO] Idemix issuer revocation public and secret keys were generated for CA 'Orderer1CA'
2022/02/23 16:43:45 [INFO] The revocation key was successfully stored. The public key is at: /moss-network/organizations/fabric-ca/orderer1/IssuerRevocationPublicKey, private key is at: /moss-network/organizations/fabric-ca/orderer1/msp/keystore/IssuerRevocationPrivateKey
2022/02/23 16:43:45 [INFO] Home directory for default CA: /moss-network/organizations/fabric-ca/orderer1
2022/02/23 16:43:45 [INFO] Initialization was successful
```

### Fabric CA docker-compose 파일 작성 및 container 실행

Fabric CA 구동을 위한 docker-compose 파일을 작성하고 실행합니다. +
compose 폴더 생성 후, fabric-samples의 'compose-ca.yaml' 파일을 다운받아 수정하여 작성합니다.

각 CA 서버의 port를 다음과 같이 사용합니다.

|===
|CA|Port

|Orderer1CA|7094

|PlatformCA|8094

|CustomerCA|9094

|Service1CA|10094

|Service2CA|11094

|===

```
mkdir compose
curl -L https://raw.githubusercontent.com/hyperledger/fabric-samples/main/test-network/compose/compose-ca.yaml -o compose/compose-ca.yaml

```